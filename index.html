<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Social Diary</title>
  <link rel="stylesheet" href="style.css"/>
  <!-- FullCalendar CSS for calendar view -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.5/main.min.css" rel="stylesheet">
  <!-- Chart.js for mood analytics -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <!-- i18next for localization -->
  <script src="https://cdn.jsdelivr.net/npm/i18next@21.9.2/dist/umd/i18next.min.js"></script>
  <!-- jsPDF for PDF exports -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Swiper for Image Sliders -->
  <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>
  <!-- FullCalendar JS -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.5/main.min.js"></script>
</head>
<body>
  <!-- Splash Screen -->
  <div id="splashScreen" class="splash-screen">
    <h1>Social Diary</h1>
    <img src="icons/icon-192.png" alt="App Icon">
  </div>

  <!-- PIN Lock Screen -->
  <div id="pin-lock" class="pin-lock-screen">
    <input id="pinInput" type="password" placeholder="Enter PIN" />
    <button id="unlockBtn">Unlock</button>
    <div id="pinError" class="error-msg"></div>
  </div>

  <!-- Header -->
  <header class="app-header">
    <div class="header-left">
      <img id="profilePicHeader" class="avatar-img" src="icons/icon-192.png" alt="Profile Picture">
      <div class="greeting-text">
        <h2 id="usernameDisplay">Hi, Guest üëã</h2>
      </div>
    </div>
    <div class="app-brand">Social Diary</div>
  </header>

  <!-- Main App -->
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <h3 id="sidebarUsername">Guest</h3>
      <button id="newEntryBtn" class="action-btn">New Entry</button>
      <button id="viewEntriesBtn" class="action-btn">View Entries</button>
      <button id="friendsBtn" class="action-btn">Friends</button>
      <button id="statsBtn" class="action-btn">Stats</button>
      <button id="settingsBtn" class="action-btn">Settings</button>
      <button id="logoutBtn" class="action-btn">Logout</button>
    </aside>

    <!-- Content Area -->
    <main class="content-area">
      <!-- Error Banner -->
      <div id="error-banner" class="error-banner" hidden></div>

      <!-- Sections -->
      <section id="newEntrySection" class="section active">
        <div class="diary-container">
          <div class="diary-binding"></div>
          <h2>Write Today's Entry</h2>
          <p id="today-date"></p>
          <div id="ai-prompt" class="ai-prompt" aria-live="polite"></div>
          <form id="diaryForm">
            <div class="form-group">
              <label for="entryTitle">Title</label>
              <input type="text" id="entryTitle" required />
            </div>
            <div class="form-group">
              <label for="entryContent">Your Thoughts</label>
              <textarea id="entryContent" rows="5" required></textarea>
            </div>
            <div class="form-group">
              <label>Mood</label>
              <div class="mood-options">
                <button type="button" class="mood-option" data-mood="Happy">üòä</button>
                <button type="button" class="mood-option" data-mood="Sad">üò¢</button>
                <button type="button" class="mood-option" data-mood="Excited">üéâ</button>
                <button type="button" class="mood-option" data-mood="Angry">üò£</button>
                <button type="button" class="mood-option" data-mood="Calm">üòå</button>
              </div>
              <p id="selectedMood"></p>
            </div>
            <div class="form-group">
              <label for="imageInput">Add Photos</label>
              <input type="file" id="imageInput" accept="image/*" multiple />
              <input type="file" id="videoInput" accept="video/*" />
              <input type="file" id="voiceInput" accept="audio/*" />
              <button type="button" id="recordVoiceBtn">üéôÔ∏è Record</button>
              <div id="previewImages"></div>
              <button type="button" id="removeImageBtn">Remove Media</button>
            </div>
            <div class="form-group">
              <label for="tagsInput">Tags</label>
              <input type="text" id="tagsInput" />
              <button type="button" id="addTagBtn">Add Tag</button>
              <div id="tagsDisplay" class="tags-container"></div>
              <div id="tagSuggestions"></div>
            </div>
            <button type="submit">Save Entry</button>
            <div id="formError" class="error-msg"></div>
          </form>
          <button id="toggleEmojiPicker">Add Emoji</button>
          <div id="emojiList" aria-hidden="true"></div>
        </div>
      </section>

      <section id="viewEntriesSection" class="section">
        <div class="diary-container">
          <button id="toggle-view">Switch to Calendar</button>
          <div id="calendar" style="display: none;"></div>
          <input type="text" id="searchInput" placeholder="Search entries..." />
          <select id="sortSelect">
            <option value="date-desc">Newest First</option>
            <option value="date-asc">Oldest First</option>
            <option value="title">Title</option>
            <option value="mood">Mood</option>
          </select>
          <button id="filterFavoritesBtn">Show Favorites</button>
          <div id="entriesList"></div>
        </div>
      </section>

      <section id="entryDetailSection" class="section">
        <div class="diary-container">
          <h2 id="detailTitle"></h2>
          <p id="detailDate" class="entry-meta"></p>
          <p id="detailMood" class="entry-meta"></p>
          <div id="detailTags" class="entry-tags"></div>
          <p id="detailContent" class="entry-content"></p>
          <div id="imageSlider" class="image-slider"></div>
          <button id="backToListBtn">Back</button>
          <button id="deleteEntryBtn">Delete</button>
          <form id="editEntryForm" class="edit-form">
            <input type="text" id="editTitle" required />
            <textarea id="editContent" rows="5" required></textarea>
            <select id="editMood">
              <option value="Happy">Happy</option>
              <option value="Sad">Sad</option>
              <option value="Excited">Excited</option>
              <option value="Angry">Angry</option>
              <option value="Calm">Calm</option>
            </select>
            <input type="file" id="editImageInput" accept="image/*" multiple />
            <input type="file" id="editVideoInput" accept="video/*" />
            <input type="file" id="editVoiceInput" accept="audio/*" />
            <div id="editImages"></div>
            <button type="button" id="removeEditImages">Remove Media</button>
            <input type="text" id="editTagsInput" placeholder="Add tags" />
            <button type="button" id="editAddTagBtn">Add Tag</button>
            <div id="editTagsDisplay" class="tags-container"></div>
            <button type="submit">Save Changes</button>
            <div id="editFormError" class="edit-error"></div>
          </form>
        </div>
      </section>

      <section id="friendsSection" class="section">
        <div class="diary-container">
          <h2>Friends</h2>
          <button id="create-group" class="action-btn">Create Group Diary</button>
          <div id="group-list"></div>
          <form class="friend-form">
            <input type="text" id="friendNameInput" placeholder="Friend's Name" />
            <input type="text" id="friendEmojiInput" placeholder="Emoji" maxlength="2" />
            <button type="button" id="addFriendBtn">Add Friend</button>
          </form>
          <div id="friendList"></div>
        </div>
      </section>

      <section id="statsSection" class="section">
        <div class="diary-container">
          <h2>Statistics</h2>
          <canvas id="moodChart"></canvas>
          <canvas id="tagChart"></canvas>
        </div>
      </section>

      <section id="settingsSection" class="section">
        <div class="diary-container">
          <h2>Settings</h2>
          <img id="profilePic" class="avatar-img" src="icons/icon-192.png" alt="Profile Picture">
          <input type="file" id="profilePicInput" accept="image/*">
          <select id="themeSelect">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
            <option value="blue">Blue</option>
            <option value="green">Green</option>
            <option value="eye-protection">Eye Protection</option>
          </select>
          <input type="password" id="newPinInput" placeholder="New PIN" maxlength="6">
          <input type="time" id="reminderTime">
          <label><input type="checkbox" id="reminderToggle"> Enable Reminder</label>
          <select id="language-select">
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="zh">Mandarin</option>
            <option value="hi">Hindi</option>
          </select>
          <button id="saveSettingsBtn">Save Settings</button>
          <button id="exportDataBtn">Export Data</button>
          <button id="importDataBtn">Import Data</button>
          <input type="file" id="importDataInput" accept=".json" hidden>
          <button id="export-entries">Export as PDF</button>
        </div>
      </section>

      <section id="chatbotSection" class="section">
        <div class="diary-container">
          <h2>Chat with AI</h2>
          <div id="chat-messages" class="chat-messages"></div>
          <input type="text" id="chat-input" placeholder="Ask your AI companion...">
          <button id="send-chat">Send</button>
        </div>
      </section>
    </main>
  </div>

  <!-- Footer -->
  <footer>
    <a href="privacy.html">Privacy Policy</a> |
    <a href="https://play.google.com/store">Get on Google Play</a> |
    <a href="https://www.apple.com/app-store/">Get on App Store</a>
  </footer>

  <!-- reCAPTCHA container -->
  <div id="recaptcha-container"></div>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js')
        .then(() => console.log('Service Worker registered'))
        .catch(err => console.error('Service Worker registration failed:', err));
    }
  </script>
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="script.js"></script>
</body>
</html>

